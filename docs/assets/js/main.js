"use strict";const inputSearch=document.querySelector(".js-inputSearch"),inputBtnSearch=document.querySelector(".js-inputBtnSearch"),inputBtnReset=document.querySelector(".js-inputBtnReset"),seriesListHTML=document.querySelector(".js-seriesList"),favoriteList=document.querySelector(".js-seriesFavourite"),form=document.querySelector(".js-form");let show=[],favorite=[];function handlesubmit(e){e.preventDefault()}function getAPI(){return"//api.tvmaze.com/search/shows?q="+inputSearch.value}function searchSeries(){let e=getAPI();fetch(e).then(e=>e.json()).then(e=>{show=e,paintListSeries()})}function handleFilter(){paintListSeries()}function paintListSeries(){seriesListHTML.innerHTML="";for(const e of show){const i=e.show.name,t=e.show.image,s=e.show.id;let n="",r="";const a="https://via.placeholder.com/210x295/ffffff/666666/?text=TV%27",o=favorite.findIndex(e=>e.show.id===s);r=null===t?a:e.show.image.medium,n=-1!==o?`<li class="elementListSeries js-seriesTitle" id=${s}>\n              <div class="seriesDiv js-seriesDivClick seriesDivClick ">\n                <h2 class="titleSeries">${i}</h2>\n                <img class="img js-seriesImg" src=${r} alt${i}>\n              </div>\n            </li>`:`<li class="elementListSeries js-seriesTitle" id=${s}>\n            <div class="seriesDiv js-seriesDivClick ">\n              <h2 class="titleSeries">${i}</h2>\n              <img class="img js-seriesImg" src=${r} alt${i}>\n            </div>\n          </li>`,seriesListHTML.innerHTML+=n}listenLiSeries(),inputSearch.value=""}function listenLiSeries(){const e=document.querySelectorAll(".js-seriesTitle");for(const i of e)i.addEventListener("click",handleSeries)}function handleSeries(e){const i=parseInt(e.currentTarget.id),t=show.find(e=>e.show.id===i),s=favorite.findIndex(e=>e.show.id===i);-1===s?favorite.push(t):favorite.splice(s,1),paintFavouriteSeries(),setLocalStorage(),paintListSeries()}function paintFavouriteSeries(){favoriteList.innerHTML="";for(const e of favorite){const i=e.show.name,t=e.show.image,s=e.show.id,n="https://via.placeholder.com/210x295/ffffff/666666/?text=TV%27";if(null===t){const e=`<li class="elementListSeriesFav" id=${s}>\n          <div class="seriesDivFav js-seriesDivClick">\n            <h2 class="titleSeriesFav">${i}</h2>\n            <img class="imgFav  js-seriesImg" src=${n} alt${i}>\n            <form class=""js-formFavReset">\n            <input type="button" id=${s} class="buttonResetFav js-miniButtonReset" value='X'>\n            </form>\n          </div>\n        </li>`;favoriteList.innerHTML+=e}else{const t=`<li class="elementListSeriesFav" id=${s}>\n           <div class="seriesDivFav js-seriesDivClick">\n             <h2 class="titleSeriesFav">${i}</h2>\n             <img class="imgFav js-seriesImg" src=${e.show.image.medium} alt${i}>\n             <form class="js-formfavReset">\n             <input type="button" id=${s} class="buttonResetFav js-miniButtonReset" value='X'>\n             </form>\n           </div>\n         </li>`;favoriteList.innerHTML+=t}}listenMiniClose()}function handleClickSearch(e){e.preventDefault(),searchSeries()}function handleClickReset(e){e.preventDefault(),favorite=[],paintFavouriteSeries(),setLocalStorage()}function handleMiniClickReset(e){console.log(e.currentTarget);const i=parseInt(e.currentTarget.id),t=favorite.findIndex(e=>e.show.id===i);-1!==t&&favorite.splice(t,1),console.log(t),paintFavouriteSeries(),setLocalStorage()}function listenMiniClose(){const e=document.querySelectorAll(".js-miniButtonReset");for(let i of e)i.addEventListener("click",handleMiniClickReset)}function setLocalStorage(){const e=JSON.stringify(favorite);localStorage.setItem("favorite",e)}function getLocalStorage(){let e=localStorage.getItem("favorite");if(null===e)handleClickSearch();else{const i=JSON.parse(e);favorite=i,paintFavouriteSeries()}}form.addEventListener("submit",handlesubmit),inputSearch.addEventListener("keyUp",handleFilter),inputBtnSearch.addEventListener("click",handleClickSearch),inputBtnReset.addEventListener("click",handleClickReset),getLocalStorage();